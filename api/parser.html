<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>Content parsers</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Lambda-blog</span> <span class="project-version">1.0.4</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="entities.html"><div class="inner"><span>Entities</span></div></a></li><li class="depth-1 "><a href="generation.html"><div class="inner"><span>Generation pipeline</span></div></a></li><li class="depth-1 "><a href="middleware.html"><div class="inner"><span>Generator middleware</span></div></a></li><li class="depth-1  current"><a href="parser.html"><div class="inner"><span>Content parsers</span></div></a></li><li class="depth-1 "><a href="templates.html"><div class="inner"><span>HTML templates</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>lambda-blog</span></div></div></li><li class="depth-2 branch"><a href="lambda-blog.generator.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>generator</span></div></a></li><li class="depth-2 branch"><a href="lambda-blog.middleware.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>middleware</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>parsers</span></div></div></li><li class="depth-3"><a href="lambda-blog.parsers.md.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>md</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>templates</span></div></div></li><li class="depth-3 branch"><a href="lambda-blog.templates.archives.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>archives</span></div></a></li><li class="depth-3 branch"><a href="lambda-blog.templates.bits.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>bits</span></div></a></li><li class="depth-3 branch"><a href="lambda-blog.templates.entries.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>entries</span></div></a></li><li class="depth-3 branch"><a href="lambda-blog.templates.page.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>page</span></div></a></li><li class="depth-3 branch"><a href="lambda-blog.templates.rss.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>rss</span></div></a></li><li class="depth-3"><a href="lambda-blog.templates.tags.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tags</span></div></a></li><li class="depth-2"><a href="lambda-blog.utils.html"><div class="inner"><span class="tree" style="top: -207px;"><span class="top" style="height: 216px;"></span><span class="bottom"></span></span><span>utils</span></div></a></li></ul></div><div class="document" id="content"><div class="doc"><div class="markdown"><p>Timestamp: #inst &ldquo;2016-01-26T16:43:00&rdquo; Title: &ldquo;Content parsers&rdquo; ID: parsers</p>
<h1><a href="#content-parsers" name="content-parsers"></a>Content parsers</h1>
<p><strong>λ-blog</strong> uses a very simple scheme of content management - you supply paths to files containing your content, and tell how to process them by specifying a <em>parser</em>.</p>
<p>A parser is simply a Clojure function that takes a single argument - the text contents of a file, and returns a data structure representing it. The returned data structure can be arbitrary as long as your generation pipeline knows how to handle it. A sensible idea is to return a Clojure map containing processed file contents &amp; some metadata.</p>
<p>Here&rsquo;s a simple definition of such a parser:</p>
<pre><code class="clojure">(defn hello-parser [contents]
  {:metadata {:length (count contents)}
   :contents (str &quot;&lt;h1&gt;Hello world!&lt;/h1&gt;&lt;p&gt;&quot; contents &quot;&lt;/p&gt;&quot;)})
</code></pre>
<h2><a href="#builtin-parsers" name="builtin-parsers"></a>Builtin parsers</h2>
<p>Out of the box, <strong>λ-blog</strong> comes bundled with a Markdown parser based on <a href="https://github.com/yogthos/markdown-clj">markdown-clj</a>. To use it, simply require its namespace and add it to your generation pipeline:</p>
<pre><code class="clojure">(require &#39;[lambda-blog.parsers.md :as md])

;; Elswhere in the code:
(-&gt; filename
    slurp
    md/parse)
</code></pre>
<p>The value returned is a Clojure map containing at least <code>:contents</code> &amp; <code>:metadata</code> keys:</p>
<pre><code class="clojure-repl">user=&gt; (md/parse &quot;Some: \&quot;Metadata\&quot;\n\n# Some\nMarkdown\n## Contents&quot;)
{:metadata {:some &quot;Metadata&quot;}
 :contents &quot;&lt;h1&gt;Some&lt;/h1&gt;Markdown&lt;h2&gt;Contents&lt;/h2&gt;&quot;}
</code></pre>
<p>Each of metadata value is assumed to be in <a href="https://github.com/edn-format/edn">Clojure EDN</a> format and thus is parsed as such. In order to give a certain metadata key multiple values, simply use a Clojure vector:</p>
<pre><code class="clojure-repl">user=&gt; (md/parse &quot;Some: [Multiple Values]\n\n# Some\nMarkdown\n## Contents&quot;)
{:metadata {:some [Multiple Values]}
 :contents &quot;&lt;h1&gt;Some&lt;/h1&gt;Markdown&lt;h2&gt;Contents&lt;/h2&gt;&quot;}
</code></pre></div></div></div></body></html>